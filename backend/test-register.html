<!doctype html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Test Register API - ProjectAI</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            .container {
                background: white;
                border-radius: 20px;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
                max-width: 1000px;
                width: 100%;
                overflow: hidden;
            }

            .header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 30px;
                text-align: center;
            }

            .header h1 {
                font-size: 32px;
                margin-bottom: 10px;
            }

            .content {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 30px;
                padding: 30px;
            }

            .form-section,
            .response-section {
                padding: 20px;
            }

            .form-section {
                border-right: 2px solid #f0f0f0;
            }

            .form-group {
                margin-bottom: 20px;
            }

            label {
                display: block;
                margin-bottom: 8px;
                font-weight: 600;
                color: #333;
            }

            input {
                width: 100%;
                padding: 12px 15px;
                border: 2px solid #e0e0e0;
                border-radius: 8px;
                font-size: 14px;
                transition: all 0.3s;
            }

            input:focus {
                outline: none;
                border-color: #667eea;
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            }

            button {
                width: 100%;
                padding: 15px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: transform 0.2s;
            }

            button:hover {
                transform: translateY(-2px);
            }

            button:active {
                transform: translateY(0);
            }

            button:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }

            .response-section h3 {
                margin-bottom: 15px;
                color: #333;
            }

            pre {
                background: #f8f9fa;
                border: 2px solid #e0e0e0;
                border-radius: 8px;
                padding: 20px;
                overflow-x: auto;
                font-size: 13px;
                line-height: 1.6;
                max-height: 400px;
                overflow-y: auto;
            }

            .success pre {
                background: #d4edda;
                border-color: #28a745;
                color: #155724;
            }

            .error pre {
                background: #f8d7da;
                border-color: #dc3545;
                color: #721c24;
            }

            .loading {
                text-align: center;
                padding: 40px;
            }

            .spinner {
                border: 4px solid #f3f3f3;
                border-top: 4px solid #667eea;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin: 0 auto 15px;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .info-box {
                background: #e7f3ff;
                border-left: 4px solid #2196f3;
                padding: 15px;
                margin-bottom: 20px;
                border-radius: 4px;
            }

            .info-box h4 {
                color: #1976d2;
                margin-bottom: 8px;
            }

            .info-box p {
                color: #555;
                font-size: 14px;
                line-height: 1.5;
            }

            @media (max-width: 768px) {
                .content {
                    grid-template-columns: 1fr;
                }

                .form-section {
                    border-right: none;
                    border-bottom: 2px solid #f0f0f0;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üß™ Test Register API</h1>
                <p>ProjectAI - Project Management System</p>
            </div>

            <div class="content">
                <div class="form-section">
                    <div class="info-box">
                        <h4>üìù H∆∞·ªõng d·∫´n:</h4>
                        <p>
                            Nh·∫≠p th√¥ng tin ƒë·ªÉ test API ƒëƒÉng k√Ω. Email ph·∫£i
                            unique (ch∆∞a t·ªìn t·∫°i trong database).
                        </p>
                    </div>

                    <form id="registerForm">
                        <div class="form-group">
                            <label for="name">üë§ T√™n ƒë·∫ßy ƒë·ªß:</label>
                            <input
                                type="text"
                                id="name"
                                placeholder="Nguy·ªÖn VƒÉn A"
                                value="Test User"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="email">üìß Email:</label>
                            <input
                                type="email"
                                id="email"
                                placeholder="test@example.com"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="password">üîí M·∫≠t kh·∫©u:</label>
                            <input
                                type="password"
                                id="password"
                                placeholder="√çt nh·∫•t 6 k√Ω t·ª±"
                                value="123456"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword"
                                >üîí X√°c nh·∫≠n m·∫≠t kh·∫©u:</label
                            >
                            <input
                                type="password"
                                id="confirmPassword"
                                placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u"
                                value="123456"
                                required
                            />
                        </div>

                        <button type="submit" id="submitBtn">
                            <span id="btnText">‚úÖ ƒêƒÉng K√Ω</span>
                        </button>
                    </form>
                </div>

                <div class="response-section">
                    <h3>üìä Response:</h3>
                    <div id="responseBox">
                        <pre>
Ch∆∞a c√≥ k·∫øt qu·∫£. H√£y ƒëi·ªÅn form v√† click "ƒêƒÉng K√Ω"...</pre
                        >
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Auto-generate random email
            document.getElementById("email").value =
                `user${Math.floor(Math.random() * 10000)}@example.com`;

            document
                .getElementById("registerForm")
                .addEventListener("submit", async (e) => {
                    e.preventDefault();

                    const submitBtn = document.getElementById("submitBtn");
                    const btnText = document.getElementById("btnText");
                    const responseBox = document.getElementById("responseBox");

                    // Disable button
                    submitBtn.disabled = true;
                    btnText.innerHTML = "‚è≥ ƒêang g·ª≠i...";

                    // Get form data
                    const data = {
                        name: document.getElementById("name").value.trim(),
                        email: document.getElementById("email").value.trim(),
                        password: document.getElementById("password").value,
                        confirmPassword:
                            document.getElementById("confirmPassword").value,
                    };

                    // Show loading
                    responseBox.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>ƒêang g·ª≠i request ƒë·∫øn server...</p>
                </div>
            `;

                    try {
                        const startTime = Date.now();

                        const response = await fetch(
                            "http://localhost:5000/api/auth/register",
                            {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify(data),
                            }
                        );

                        const responseTime = Date.now() - startTime;
                        const result = await response.json();

                        // Clear classes
                        responseBox.className = "";

                        if (result.success) {
                            // Success
                            responseBox.className = "success";
                            responseBox.innerHTML = `<pre>‚úÖ TH√ÄNH C√îNG! (${responseTime}ms)

üì¶ Response Status: ${response.status} ${response.statusText}

üé´ Token:
${result.data.token}

üë§ User Info:
- ID: ${result.data.user.id}
- Name: ${result.data.user.name}
- Email: ${result.data.user.email}
- Role: ${result.data.user.role}
- Created: ${new Date(result.data.user.createdAt).toLocaleString("vi-VN")}

üìÑ Full Response:
${JSON.stringify(result, null, 2)}</pre>`;

                            // Save token
                            localStorage.setItem("token", result.data.token);
                            localStorage.setItem(
                                "user",
                                JSON.stringify(result.data.user)
                            );

                            // Reset form with new random email
                            document.getElementById("name").value = "Test User";
                            document.getElementById("email").value =
                                `user${Math.floor(Math.random() * 10000)}@example.com`;
                            document.getElementById("password").value =
                                "123456";
                            document.getElementById("confirmPassword").value =
                                "123456";
                        } else {
                            // Error from API
                            responseBox.className = "error";
                            responseBox.innerHTML = `<pre>‚ùå L·ªñI! (${responseTime}ms)

üì¶ Response Status: ${response.status} ${response.statusText}

üìÑ Response:
${JSON.stringify(result, null, 2)}</pre>`;
                        }
                    } catch (error) {
                        // Network error
                        responseBox.className = "error";
                        responseBox.innerHTML = `<pre>‚ùå L·ªñI K·∫æT N·ªêI!

Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn server. H√£y ki·ªÉm tra:

1. Server c√≥ ƒëang ch·∫°y kh√¥ng?
   ‚Üí cd backend && npm run dev

2. Port c√≥ ƒë√∫ng l√† 5000 kh√¥ng?
   ‚Üí netstat -ano | findstr :5000

3. CORS c√≥ ƒë∆∞·ª£c config kh√¥ng?
   ‚Üí Ki·ªÉm tra file server.js

Chi ti·∫øt l·ªói:
${error.message}

Stack trace:
${error.stack}</pre>`;
                    } finally {
                        // Re-enable button
                        submitBtn.disabled = false;
                        btnText.innerHTML = "‚úÖ ƒêƒÉng K√Ω";
                    }
                });
        </script>
    </body>
</html>
